{"version":3,"file":"base-context.js","sources":["../../../src/models/base-context.ts"],"sourcesContent":["import { Branding, Client, Prompt, Screen, Organization, User, Transaction, Tenant, UntrustedData } from '../models';\n\nimport type {\n  ClientMembers,\n  PromptMembers,\n  ScreenMembers,\n  OrganizationMembers,\n  UserMembers,\n  TransactionMembers,\n  TenantMembers,\n  UntrustedDataMembers,\n  BrandingMembers\n} from '../../interfaces/models';\nimport type { BaseContext as UniversalLoginContext, BaseMembers } from '../../interfaces/models/base-context';\nimport type { Error as TransactionError } from '../../interfaces/models/transaction';\n\n/**\n * @class BaseContext\n * @description Foundation class that provides access to the Universal Login Context, which contains all information\n * about the current authentication flow, including user data, client information, and screen configuration.\n */\nexport class BaseContext implements BaseMembers {\n  branding: BrandingMembers;\n  screen: ScreenMembers;\n  tenant: TenantMembers;\n  prompt: PromptMembers;\n  organization: OrganizationMembers;\n  client: ClientMembers;\n  transaction: TransactionMembers;\n  user: UserMembers;\n  untrustedData: UntrustedDataMembers;\n\n  private static context: UniversalLoginContext | null = null;\n\n  /**\n   * @property {string} screenIdentifier - Identifier for the current screen, used to verify correct screen imports\n   */\n  static screenIdentifier: string = '';\n\n  /**\n   * @constructor\n   * @description Initializes a new instance of the BaseContext class and populates its properties with data from the Universal Login Context.\n   * @throws {Error} If Universal Login Context is not available or screen identifier doesn't match.\n   */\n  constructor() {\n    if (!BaseContext.context) {\n      const globalWindow = window as unknown as { universal_login_context?: UniversalLoginContext };\n      BaseContext.context = globalWindow.universal_login_context ?? null;\n    }\n\n    const context = BaseContext.context;\n    const screenIdentifier: string = new.target?.screenIdentifier;\n\n    if (!context) {\n      throw new Error('Universal Login Context is not available on the global window object.');\n    }\n\n    if (screenIdentifier !== context?.screen?.name && screenIdentifier !== '') {\n      throw new Error(\n        `Incorrect import: The current screen name does not match the imported screen class. Imported Screen: ${screenIdentifier}, Current Screen: ${context?.screen?.name}`,\n      );\n    }\n\n    this.branding = new Branding(context.branding);\n    this.screen = new Screen(context.screen);\n    this.tenant = new Tenant(context.tenant);\n    this.prompt = new Prompt(context.prompt);\n    this.organization = new Organization(context.organization);\n    this.client = new Client(context.client);\n    this.transaction = new Transaction(context.transaction);\n    this.user = new User(context.user);\n    this.untrustedData = new UntrustedData(context.untrusted_data);\n  }\n\n  /**\n   * Retrieves a specific part of the Universal Login Context.\n   * @template K - The key type of the UniversalLoginContext\n   * @param {K} model - The key of the context to retrieve\n   * @returns {UniversalLoginContext[K] | undefined} The requested context portion or undefined if not available\n   * @ignore - Internal method not intended for public use\n   */\n  getContext<K extends keyof UniversalLoginContext>(model: K): UniversalLoginContext[K] | undefined {\n    if (!BaseContext.context) {\n      const globalWindow = window as unknown as { universal_login_context?: UniversalLoginContext };\n      BaseContext.context = globalWindow.universal_login_context ?? null;\n    }\n\n    if (!BaseContext.context) {\n      return undefined;\n    }\n\n    return BaseContext.context[model];\n  }\n\n  /**\n  * Retrieves the array of transaction errors from the context, or an empty array if none exist.\n  * @returns {TransactionError[]} An array of error objects from the transaction context.\n  */\n  getError(): TransactionError[] {\n    return this.transaction?.errors ?? [];\n  }\n}\n"],"names":["BaseContext","branding","screen","tenant","prompt","organization","client","transaction","user","untrustedData","static","constructor","context","globalWindow","window","universal_login_context","screenIdentifier","Error","name","this","Branding","Screen","Tenant","Prompt","Organization","Client","Transaction","User","UntrustedData","untrusted_data","getContext","model","getError","errors"],"mappings":"wXAqBaA,EACXC,SACAC,OACAC,OACAC,OACAC,aACAC,OACAC,YACAC,KACAC,cAEQC,eAA+C,KAKvDA,wBAAkC,GAOlC,WAAAC,GACE,IAAKX,EAAYY,QAAS,CACxB,MAAMC,EAAeC,OACrBd,EAAYY,QAAUC,EAAaE,yBAA2B,KAGhE,MAAMH,EAAUZ,EAAYY,QACtBI,cAAuCA,iBAE7C,IAAKJ,EACH,MAAM,IAAIK,MAAM,yEAGlB,GAAID,IAAqBJ,GAASV,QAAQgB,MAA6B,KAArBF,EAChD,MAAM,IAAIC,MACR,wGAAwGD,sBAAqCJ,GAASV,QAAQgB,QAIlKC,KAAKlB,SAAW,IAAImB,EAASR,EAAQX,UACrCkB,KAAKjB,OAAS,IAAImB,EAAOT,EAAQV,QACjCiB,KAAKhB,OAAS,IAAImB,EAAOV,EAAQT,QACjCgB,KAAKf,OAAS,IAAImB,EAAOX,EAAQR,QACjCe,KAAKd,aAAe,IAAImB,EAAaZ,EAAQP,cAC7Cc,KAAKb,OAAS,IAAImB,EAAOb,EAAQN,QACjCa,KAAKZ,YAAc,IAAImB,EAAYd,EAAQL,aAC3CY,KAAKX,KAAO,IAAImB,EAAKf,EAAQJ,MAC7BW,KAAKV,cAAgB,IAAImB,EAAchB,EAAQiB,gBAUjD,UAAAC,CAAkDC,GAChD,IAAK/B,EAAYY,QAAS,CACxB,MAAMC,EAAeC,OACrBd,EAAYY,QAAUC,EAAaE,yBAA2B,KAGhE,GAAKf,EAAYY,QAIjB,OAAOZ,EAAYY,QAAQmB,GAO7B,QAAAC,GACE,OAAOb,KAAKZ,aAAa0B,QAAU"}